---
layout: post
title: ssh tips
date: 2023-07-13 10:30:00
description: a collection of ssh tips
tags: linux
categories: notes
---
## SSH Clients
The default SSH client for both Mac and Linux systems is the Terminal application. However, for Windows users, alternatives are available such as PuTTY, Bitvise SSH Client, and MobaXterm, which offer a range of features suited to different user preferences and needs.

### Terminal (Mac and Linux)
``` bash
ssh username@host  # host = the ip address of server, i.e., @35.8.72.123 or @hpcc.msu.edu
```

### SSH Clients for Windows
Here is a [blog](https://www.softwaretestinghelp.com/ssh-clients-for-windows/) about SSH clients for Windows. For a simple start, you can use PuTTY or MobaXterm to access servers and use FileZilla for sending and receiving files. 
**NOTE**: the terminal in VScode is another option.

## SSH tricks

### `ssh-copy-id user@remote`
It's more secure and convenient.
Generate a new key pair using `ssh-keygen`, and copyt the public key to the remote server.

### Run a command over SSH
The basic syntax is `ssh user@remote "command"`

### Tunnel other applications
SSH can provide an authenticated and encrypted connection to remote devices for other applications.

Virtual Network Computing (VNC) is a useful way to connect to a remote desktop when you need a graphical user interface (GUI) to accomplish your task.

Not all VNC products provide encryption for data transfer (however, they usually do for the authentication stage). You can tunnel your VNC connection over SSH for added privacy.

You need to forward ports for this to work. Type the following:
``` bash
$ ssh -L 5901:localhost:5901 -N -f -l user01@server01
```
Launch the VNC client and connect to `localhost:5901`,
which is now forwarded to the remote server.

Here's an explanation of the options in the command above:
* `-L`: Forward the port to the destination device. In this case, it's a direct mapping of 5901 to 5901 (the default VNC port number).
* `-N`: Only forward ports and do not execute commands.
* `-f`: Put SSH in the background after the connection is established (freeing the command prompt).
* `-l`: This option specifies the remote SSH user and destination server.
Similarly, you could establish an HTTP-over-SSH tunnel to a directory named **images**
with a command like this:
``` bash
$ ssh -L 11000:localhost:80 -N -f -l user01@server01
```
Next, start a web browser and connect to `http://localhost:11000/images`

### an SSH tunnel for a Jupyter Notebook
1. First, ensure that you have SSH access to the remote server and that the Jupyter Notebook server is running on it. You can start the Jupyter Notebook server on the remote machine by running:
```
jupyter notebook --no-browser --port=<remote_port>
```
Replace `<remote_port>` with an available port number on the remote server (e.g., `8888`).
2. On your local machine, create an SSH tunnel with local port forwarding by running:
```
ssh -L <local_port>:localhost:<remote_port> <user>@<remote_server>
```
Replace `<local_post>` with an available port number on your local machine (e.g., `8889`),
`<remote_port>` with the port number you used in step 1,
`<user>` with your username on the remote server, 
and `<remote_server>` with the remote server's IP address of hostname.

For example:
```
ssh -L 8889:localhost:8888 user@exmaple.com
```
This command forwards the local port `8889` to the remote server's port `8888`.
3. Open a web browser on your local machine and enter the following URL:
```
https://localhost:<local_port>
```
Replace `<local_port>` with the local port number you userd in step 2 (e.g., `8889`).
4. When prompted, enter the Jupyter Notebook token or password. You can find the token in the console output of the Jupyter Notebook server on the remote machine


### an example to use VSCODE by setting up an SSH tunnel and using the Remote - SSH extension
1. Install the Remote - SSH extension from the VSCode extension marketplace
2. Set up the SSH tunnel to forward connections from your local machine to the remote server. You can do this by executing the following command in your terminal:
``` bash
ssh -L 5901:localhost:5901 -N -f -l user01@server01
```
This command creates a secure tunnel where `8888` is the port number used by the Jupyter notebook
3. Once the SSH tunnel is set up, you can connect to the remote server from VSCode. Click on the green bottom-left corner button (or use the command palette `Ctrl+Shift+P` > `Remote-SSH: Connect to Host...`), then select `Add New SSH Host...` and input your ssh command `user01@server01`.
4. Open the remote server in a new window. VSCode will install its server on the remote machine and connect to it.
5. Now, on the remote machine, start the Jupyter notebook by typing `jupyter notebook --no-browser --port=8888` in the terminal. The `--no-browser` option prevents the opening of a web browser on the remote server and `--port=8888` specifies the port to use for this notebook.
6. In your local VSCode, you can open a new browser or a new tab and go to `localhost:8888`. You should be able to see the Jupyter notebook running.
7. If a token is required, go back to your terminal where you launched the Jupyter notebook. You should see a line that contains token=<your-token>. Copy the token and paste it into your browser.

Replace `user01@server01` and `8888` with your actual username, server address, and the port you want to use for the notebook.
