<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>On preconditioning the treecode-accelerated boundary integral Poisson-Boltzmann solver | Jiahui Chen</title> <meta name="author" content="Jiahui Chen"/> <meta name="description" content="Preconditioning, GMRES, treecode, electrostatics, boundary integral, Poisson-Boltzmann equation"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/uark.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jiahuic.github.io/projects/1_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jiahui </span>Chen</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching and Mentoring</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/cv/">CV</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/talks/">Talks</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">On preconditioning the treecode-accelerated boundary integral Poisson-Boltzmann solver</h1> <p class="post-description">Preconditioning, GMRES, treecode, electrostatics, boundary integral, Poisson-Boltzmann equation</p> </header> <article> <p>This project works on a preconditioning scheme using preconditioner matrix \(M\) such that \(M^{-1}A\) has much improved condition while \(M^{-1}z\) can be rapidly computed for any vector \(z\). In this scheme, the matrix \(M\) carries the interactions between boundary elements on the same leaf only in the tree structure thus is block diagonal with many computational advantages. The sizes of the blocks in \(M\) are conveniently controlled by treecode parameter \(N_0\), the maximum number of particles per leaf. The numerical results show that this new preconditioning scheme improves the treecode-accelerated boundary integral (TABI) solver with significantly reduced iteration numbers and better accuracy, particularly for protein sets on which TABI solver previously converges slowly.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/project1/p1_f1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/project1/p1_f1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/project1/p1_f1-1400.webp"></source> <img src="/assets/img/project1/p1_f1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="treecode" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Details of treecode; (a) tree structure of particle clusters; (b) particle-cluster interaction between particle \(\textbf{x}_i\) and cluster \(c=\{\textbf{x}_j\}\); \(\textbf{x}_c\): cluster center, \(R\): particle-cluster distance, \(r_c\): cluster radius. </div> <h3 id="treecode-for-electrostatic-interactions">Treecode for electrostatic interactions</h3> <p>For a system of \(N\) particles located at \(\textbf{x}_i\) with partial charges \(q_{i}, i=1,\ldots,N\), we denote the induced potential at \(\textbf{x}_{i}\) by \begin{equation} \label{particle-particle} V_{i}=\sum_{j=1, j\neq i}^N q_{i}G(\textbf x_i, \textbf x_j) \end{equation} where \(G(\textbf x,\textbf y)\) is the Coulomb or the screened Coulomb potential, defined respectively by \begin{equation} \label{eq_CP} G_0(\textbf x, \textbf y)=\frac{1}{4\pi|\textbf x-\textbf y|} \end{equation} and \begin{equation} \label{eq_sCP} G_\kappa(\textbf x, \textbf y)=\frac{e^{-\kappa |\textbf x-\textbf y|}}{4\pi|\textbf x-\textbf y|}. \end{equation} Note we attempted to use CGI units here but supply the additional \(4\pi\) coefficient in the denominator to represent electrostatic potential generated from partial charges with units of fundamental charges, as from most force field generators such as <a href="https://www.charmm.org/" target="_blank" rel="noopener noreferrer">CHARMM</a> and <a href="https://ambermd.org/" target="_blank" rel="noopener noreferrer">AMBER</a>.</p> <h3 id="particle-cluster-interaction">Particle-cluster interaction</h3> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/project1/p1_f1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/project1/p1_f1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/project1/p1_f1-1400.webp"></source> <img src="/assets/img/project1/p1_f1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="treecode" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Details of treecode; (a) tree structure of particle clusters; (b) particle-cluster interaction between particle \(\textbf{x}_i\) and cluster \(c=\{\textbf{x}_j\}\); \(\textbf{x}_c\): cluster center, \(R\): particle-cluster distance, \(r_c\): cluster radius. </div> <p>We assume that the particles have been partitioned into a hierarchy of clusters as illustrated in above Figure (a). In the partition process, each cluster (a rectangle in 2-D or a rectangular parallelepiped in 3-D) is divided into four (or eight for 3-D) sub-clusters until the pre-determined treecode parameter \(N_0\), the maximum number of particles per leaf (a cluster without sub-clusters), is satisfied. Here we illustrate in 2-D using \(N_0=3\); the more practical 3-D case is similar. %(the procedure will be described later). Treecode evaluates the potential in Eq.~(\ref{particle-particle}) as a sum of particle-cluster interactions, \begin{equation} \label{particle_cluster_form} V_i = \sum_c V_{i,c}, \end{equation} where \begin{equation} \label{particle_cluster} V_{i,c} = \sum_{\textbf y_j \in c} q_j\, G(\textbf x_i,\textbf y_j) \end{equation} is the interaction between a target particle $\textbf x_i$ and a cluster of sources \(c=\{\textbf y_j\}\). A particle-cluster interaction is shown schematically in above figure (b): the cluster center, \(\textbf y_c\), is the geometric center of the rectangle; \(R\) is the particle-cluster distance; and the cluster radius, \(r_c\), is the distance from $\textbf y_c$ to one of the vertices of the rectangle.</p> <p>The treecode algorithmn has two options for computing a particle-cluster interaction \(V_{i,c}\). It can use direct summation as in the definition Eq.~(\ref{particle_cluster}) . In practice, the Taylor approximation is used if the following criterion is satisfied, \begin{equation} \label{mac} \frac{r_c}{R}\leq \theta, \end{equation} where \(\theta\) is a user-specified Maximum Acceptance Criterion (MAC) parameter for controlling the error. If the criterion is not satisfied, the code examines the children or sub-clusters of cluster \(c\), or it performs direct summation if \(c\) is a leaf of the tree.</p> <p>While this discussion has focused on the problem of evaluating the electrostatic potential \(V_i\), similar considerations apply to computations of the electric field \(E_i = -\nabla V_i\), where treecode can also be applied.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jiahui Chen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>